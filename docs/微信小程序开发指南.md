# 微信小程序开发指南

本文档将指导您从零开始开发智能旧衣回收箱的微信小程序。

---

## 1. 准备工作

### 1.1 注册微信小程序账号

1. **访问微信公众平台**
   - 打开 https://mp.weixin.qq.com/
   - 点击右上角「立即注册」
   - 选择「小程序」类型

2. **填写注册信息**
   - 邮箱（未注册过公众平台的）
   - 密码
   - 验证邮箱

3. **选择主体类型**
   - 个人：功能受限，无法使用支付
   - 企业：需要营业执照，功能完整
   - **建议：使用企业账号**（需要支付功能）

4. **获取重要信息**
   注册完成后，在「开发管理」→「开发设置」中获取：
   - **AppID**：小程序唯一标识
   - **AppSecret**：小程序密钥（保密）

### 1.2 下载开发工具

1. **下载微信开发者工具**
   - 访问：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
   - 选择对应系统版本（Windows/Mac）下载安装

2. **登录开发者工具**
   - 打开开发者工具
   - 使用微信扫码登录

### 1.3 配置服务器域名

在微信公众平台「开发管理」→「开发设置」→「服务器域名」中配置：

| 域名类型 | 用途 | 示例 |
|---------|------|------|
| request合法域名 | 后端API接口 | https://api.yourdomain.com |
| uploadFile合法域名 | 文件上传 | https://api.yourdomain.com |
| downloadFile合法域名 | 文件下载 | https://oss.yourdomain.com |

> **注意**：
> - 域名必须是 HTTPS
> - 域名必须备案
> - 开发阶段可在开发者工具中勾选「不校验合法域名」

---

## 2. 创建小程序项目

### 2.1 新建项目

1. 打开微信开发者工具
2. 点击「+」新建项目
3. 填写项目信息：
   - **项目名称**：智能旧衣回收
   - **目录**：选择项目存放位置
   - **AppID**：填写你的AppID（或使用测试号）
   - **开发模式**：小程序
   - **后端服务**：不使用云服务
   - **模板选择**：JavaScript - 基础模板

### 2.2 项目目录结构

```
miniprogram/
├── app.js                 # 小程序入口文件
├── app.json               # 全局配置文件
├── app.wxss               # 全局样式文件
├── project.config.json    # 项目配置文件
├── sitemap.json          # 搜索配置
│
├── pages/                 # 页面目录
│   ├── index/            # 首页
│   │   ├── index.js      # 页面逻辑
│   │   ├── index.json    # 页面配置
│   │   ├── index.wxml    # 页面结构（类似HTML）
│   │   └── index.wxss    # 页面样式（类似CSS）
│   │
│   ├── scan/             # 扫码页面
│   ├── claim/            # 领取页面
│   ├── orders/           # 订单列表页面
│   ├── wallet/           # 钱包页面
│   └── profile/          # 个人中心页面
│
├── components/           # 自定义组件
│   └── ...
│
├── utils/                # 工具函数
│   ├── request.js       # 网络请求封装
│   ├── auth.js          # 认证相关
│   └── util.js          # 通用工具
│
├── services/             # 业务服务
│   ├── user.js          # 用户服务
│   ├── order.js         # 订单服务
│   └── device.js        # 设备服务
│
├── images/               # 图片资源
│   └── ...
│
└── config/               # 配置文件
    └── index.js         # 环境配置
```

---

## 3. 核心文件说明

### 3.1 app.json - 全局配置

这是小程序的全局配置文件，定义了：
- 页面路径
- 窗口样式
- 底部Tab栏
- 网络超时等

### 3.2 app.js - 入口文件

小程序的入口，负责：
- 初始化全局数据
- 监听生命周期
- 处理登录逻辑

### 3.3 页面文件

每个页面由4个文件组成：
- `.js` - 页面逻辑（JavaScript）
- `.json` - 页面配置
- `.wxml` - 页面结构（类似HTML，使用微信自定义标签）
- `.wxss` - 页面样式（类似CSS）

---

## 4. 开发调试

### 4.1 编译预览

1. 在开发者工具中点击「编译」按钮
2. 左侧模拟器会显示小程序界面
3. 可选择不同机型进行测试

### 4.2 真机调试

1. 点击「预览」按钮
2. 用微信扫描生成的二维码
3. 在真机上查看效果

### 4.3 调试技巧

- **Console面板**：查看 console.log 输出
- **Network面板**：查看网络请求
- **AppData面板**：查看页面数据
- **Storage面板**：查看本地存储

### 4.4 常见问题

| 问题 | 解决方案 |
|-----|---------|
| 网络请求失败 | 检查域名配置，或勾选「不校验合法域名」 |
| 页面白屏 | 检查Console面板是否有报错 |
| 样式不生效 | 检查选择器是否正确，注意小程序不支持部分CSS |
| 扫码功能不可用 | 需要真机测试，模拟器不支持 |

---

## 5. 发布上线

### 5.1 上传代码

1. 在开发者工具中点击「上传」
2. 填写版本号和项目备注
3. 上传成功后在微信公众平台可见

### 5.2 提交审核

1. 登录微信公众平台
2. 进入「管理」→「版本管理」
3. 在「开发版本」中点击「提交审核」
4. 填写审核信息

### 5.3 发布上线

- 审核通过后，点击「发布」即可上线
- 审核周期一般1-7天

---

## 6. 学习资源

### 6.1 官方文档

- **开发指南**：https://developers.weixin.qq.com/miniprogram/dev/framework/
- **组件文档**：https://developers.weixin.qq.com/miniprogram/dev/component/
- **API文档**：https://developers.weixin.qq.com/miniprogram/dev/api/

### 6.2 常用API

| API | 用途 |
|-----|------|
| wx.request() | 发起网络请求 |
| wx.login() | 获取登录凭证 |
| wx.getUserProfile() | 获取用户信息 |
| wx.scanCode() | 扫码 |
| wx.getLocation() | 获取位置 |
| wx.showToast() | 显示提示 |
| wx.showModal() | 显示弹窗 |
| wx.navigateTo() | 页面跳转 |
| wx.setStorageSync() | 本地存储 |

---

## 7. 下一步

请查看 `miniprogram/` 目录下的完整代码示例，按照以下步骤开始开发：

1. 复制示例代码到你的小程序项目
2. 修改 `config/index.js` 中的API地址
3. 在开发者工具中编译运行
4. 根据业务需求修改页面和逻辑

