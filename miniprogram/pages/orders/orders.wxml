<!--pages/orders/orders.wxml-->
<!--è®¢å•åˆ—è¡¨é¡µé¢-->

<view class="container">
  <!-- çŠ¶æ€ç­›é€‰ -->
  <view class="filter-bar">
    <view class="filter-item {{currentStatus === null ? 'active' : ''}}" 
          bindtap="switchStatus" data-status="{{null}}">
      å…¨éƒ¨
    </view>
    <view class="filter-item {{currentStatus === 0 ? 'active' : ''}}" 
          bindtap="switchStatus" data-status="{{0}}">
      å¾…é¢†å–
    </view>
    <view class="filter-item {{currentStatus === 1 ? 'active' : ''}}" 
          bindtap="switchStatus" data-status="{{1}}">
      å·²é¢†å–
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list" wx:if="{{orders.length > 0}}">
    <view class="order-card card" 
          wx:for="{{orders}}" 
          wx:key="order_id"
          bindtap="viewDetail"
          data-id="{{item.order_id}}">
      <!-- è®¢å•å¤´éƒ¨ -->
      <view class="order-header">
        <text class="order-id">è®¢å•å·: {{item.order_id}}</text>
        <text class="order-status tag tag-{{item.statusInfo.type}}">
          {{item.statusInfo.text}}
        </text>
      </view>
      
      <!-- è®¢å•å†…å®¹ -->
      <view class="order-body">
        <view class="order-info">
          <text class="device-name">ğŸ“ {{item.device_name || 'æ™ºèƒ½å›æ”¶ç®±'}}</text>
          <text class="order-time">{{item.dateDisplay}}</text>
        </view>
        <view class="order-detail">
          <view class="detail-item">
            <text class="detail-label">é‡é‡</text>
            <text class="detail-value">{{item.weightDisplay}} kg</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">é‡‘é¢</text>
            <text class="detail-value amount">Â¥{{item.amountDisplay}}</text>
          </view>
        </view>
      </view>
      
      <!-- è®¢å•åº•éƒ¨ -->
      <view class="order-footer">
        <text class="carbon-text">ğŸŒ± å‡ç¢³ {{item.carbonDisplay}} kg</text>
        <text class="arrow">></text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{orders.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“‹</text>
    <text class="empty-text">æš‚æ— æŠ•é€’è®°å½•</text>
    <text class="empty-tip">å»é™„è¿‘å›æ”¶ç®±æŠ•é€’è¡£ç‰©å§</text>
    <navigator url="/pages/nearby/nearby" class="empty-btn btn btn-primary">
      æŸ¥çœ‹é™„è¿‘å›æ”¶ç®±
    </navigator>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤š -->
  <view class="no-more" wx:if="{{orders.length > 0 && !hasMore}}">
    <text>â€” æ²¡æœ‰æ›´å¤šäº† â€”</text>
  </view>
</view>

